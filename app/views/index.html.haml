%h1
  Location
.hr
  .demo
    %p{id: "demo"}
  .demo
    %button.btn.btn-default{type:"submit", onClick: "getLocation()"}
      Get My Location
  #map
%script{src:"https://maps.googleapis.com/maps/api/js"}
:javascript
  var x = document.getElementById("demo");
  var m = document.getElementById("map");

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition, error);
    } else { 
      x.innerHTML = "Geolocation is not supported by this browser.";
    }
  }

  function showPosition(position) {
    x.innerHTML = "Latitude: " + position.coords.latitude + 
    "<br>Longitude: " + position.coords.longitude;  
    m.innerHTML = "https://maps.google.com/?q=" + position.coords.latitude + "," + position.coords.longitude;
    initialize(position.coords.latitude, position.coords.longitude);
  }

  function error() {
    alert("issue retrieving position");
  }

  function initialize(lat,lng) {
    var mapCanvas = document.getElementById('map');
    var mapOptions = {
      center: new google.maps.LatLng(lat, lng),
      zoom: 15,
      mapTypeId: google.maps.ROADMAP
    }
    var map = new google.maps.Map(mapCanvas, mapOptions);

    var marker = new google.maps.Marker({  
      position: new google.maps.LatLng(lat, lng),  
      map: map  
    });

  }
